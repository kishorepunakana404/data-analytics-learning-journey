-- week1/queries.sql
-- SQL queries used for Week 1 - Sales dataset
USE data_analytics;

-- View first rows
SELECT * FROM sales LIMIT 50;

-- Total rows
SELECT COUNT(*) AS total_rows FROM sales;

-- Total sales
SELECT SUM(Sales) AS total_sales FROM sales;

-- Average sale value
SELECT ROUND(AVG(Sales),2) AS avg_sale FROM sales;

-- Sales by region
SELECT Region, SUM(Sales) AS regional_sales, COUNT(*) AS orders
FROM sales
GROUP BY Region
ORDER BY regional_sales DESC;

-- Top products by revenue
SELECT Product, SUM(Sales) AS product_revenue, COUNT(*) AS sales_count
FROM sales
GROUP BY Product
ORDER BY product_revenue DESC
LIMIT 10;

-- Monthly sales (requires OrderDate column)
SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS year_month,
       COUNT(*) AS orders, ROUND(SUM(Sales),2) AS month_sales
FROM sales
GROUP BY year_month
ORDER BY year_month;

-- Average quantity by category (requires Quantity)
SELECT Category, ROUND(AVG(Quantity),2) AS avg_quantity, SUM(Sales) AS total_sales
FROM sales
GROUP BY Category
ORDER BY total_sales DESC;

-- Top single sales (highest-value orders)
SELECT * FROM sales
ORDER BY Sales DESC
LIMIT 5;
